{% extends 'base.html' %}

{% block content %}
<div id="head">
  <div class="container text-center mt-5 p-3">
    <h2>FHS Birth Certificate Data</h2>
  </div>
</div>

<!-- Filter Form -->
<div class="card mb-4">
    <div class="card-header">Filter Certificates</div>
    <div class="card-body">
        <form method="get" class="row g-3">
            <div class="col-md-3">
                <label for="customer_name" class="form-label">Customer Name</label>
                <input type="text" class="form-control" id="customer_name" name="customer_name" value="{{ request.args.get('customer_name', '') }}">
            </div>
            <div class="col-md-3">
                <label for="customer_site" class="form-label">Customer Site</label>
                <input type="text" class="form-control" id="customer_site" name="customer_site" value="{{ request.args.get('customer_site', '') }}">
            </div>
            <div class="col-md-3">
                <label for="date_from" class="form-label">From Date</label>
                <input type="date" class="form-control" id="date_from" name="date_from" value="{{ request.args.get('date_from', '') }}">
            </div>
            <div class="col-md-3">
                <label for="date_to" class="form-label">To Date</label>
                <input type="date" class="form-control" id="date_to" name="date_to" value="{{ request.args.get('date_to', '') }}">
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-primary">Apply Filters</button>
                <a href="{{ url_for('birth_certificate') }}" class="btn btn-secondary">Reset</a>
            </div>
        </form>
    </div>
</div>

<div class="btn-group mb-3">
    <button type="button" class="btn btn-success dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
        Export Data
    </button>
    <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="{{ url_for('export_word') }}">Word Document</a></li>
        <li><a class="dropdown-item" href="{{ url_for('export_excel') }}">Excel Spreadsheet</a></li>
        <li><a class="dropdown-item" href="{{ url_for('export_pdf') }}">PDF Document</a></li>
    </ul>
</div>

<div class="card">
    <div class="card-header">
        <div class="d-flex justify-content-between align-items-center">
            <span>Birth Certificate Records</span>
            <span class="badge bg-primary">{{ certificates.total }} total records</span>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                {% if certificates.items|length == 0 %}
                  <div class="alert alert-warning alert-dismissible fade show" role="alert">
                    <strong>No data found!</strong> Try adjusting your filters or start adding FHS Birth Certificate data now.
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                {% else %}
                <thead>
                    <tr>
                        <th>Certificate ID</th>
                        <th>Customer Name</th>
                        <th>Customer Site</th>
                        <th>Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for certificate in certificates.items %}
                    <tr>
                        <td>{{ certificate.CertificateID }}</td>
                        <td>{{ certificate.CustomerName }}</td>
                        <td>{{ certificate.CustomerSite }}</td>
                        <td>{{ certificate.Date }}</td>
                        <td>
                            <a href="#" class="btn btn-sm btn-warning">Edit</a>
                            <a href="#" class="btn btn-sm btn-danger delete-btn" >Delete</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
                {% endif %}
            </table>
        </div>
        
        <!-- Pagination -->
        <nav aria-label="Birth certificates pagination">
            <ul class="pagination justify-content-center">
                {% if certificates.has_prev %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('birth_certificate', page=certificates.prev_num, **request.args) }}">Previous</a>
                    </li>
                {% endif %}
                
                {% for page_num in certificates.iter_pages() %}
                    <li class="page-item {% if page_num == certificates.page %}active{% endif %}">
                        <a class="page-link" href="{{ url_for('birth_certificate', page=page_num, **request.args) }}">{{ page_num }}</a>
                    </li>
                {% endfor %}
                
                {% if certificates.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('birth_certificate', page=certificates.next_num, **request.args) }}">Next</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>
</div>
{% endblock %}
